name: CI/CD Pipeline

on: [push]

jobs:
  SAST_SCAN:
    name: Static Application Security Testing (SAST) with Bandit
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: 3.9

    - name: Install Bandit
      run: pip install bandit

    - name: Run Bandit Scan
    #   Run Simple bandit on the codebase
    #   run: bandit -r .
    #   Run Bandit that only check medium and high severity and confidence
    #   run: bandit -ll -ii -r .
    #  Run Bandit with a configuration file
      run: bandit -ll -ii -r . -f json -o bandit-report.json

    - name: Upload Bandit Report
      uses: actions/upload-artifact@v2
      if: always()
      with:
        name: bandit-findings
        path: bandit-report.json